# AUTOGENERATED! DO NOT EDIT! File to edit: 05_experiment_tracking.ipynb (unless otherwise specified).

__all__ = ['tracker', 'first', 'last']

# Cell

import datetime
import tempfile
from pathlib import Path

import pandas as pd

from sciflow.experiment.engine import ExperimentEngine
from sciflow.experiment.tracking import MockTracker
from sciflow.run_flow import check_call_flow

# Cell

tracker = MockTracker()

# step:first


def first(tracker):
    results = {}
    if tracker:
        with tempfile.TemporaryDirectory() as temp_dir:
            tracker.log_metric("rmse", 0.5, 0)
            csv_path = f"{temp_dir}/first.csv"
            df = pd.DataFrame({"a": [1, 2, 3], "b": ["a", "b", "c"]})
            df.to_csv(csv_path)
            tracker.add_artifact(csv_path)
    return results

# step:last


def last(tracker):
    results = {}
    if tracker:
        with tempfile.TemporaryDirectory() as temp_dir:
            tracker.log_metric("r2", 0.9, 0)
            df = pd.DataFrame({"a": [1, 2, 3], "b": ["a", "b", "c"]})
            fig = df.a.plot.hist().figure
            png_path = f"{temp_dir}/last.png"
            fig.savefig(png_path)
            tracker.add_artifact(png_path)
    return results